//----------------------------------------------------------------NS_CAMPAIGNvar NS_CAMPAIGN = new function(){//------VARIABLES    	var vars = {            campaignOpenHeight		: 600,            campaignClosedHeight	: 550,            campaignAutoStart		: true,            currentSlideShowJSON	: null            //galleryScrollable : window.scrollableAPI.items()        };        this.campaignOpen	= false;	    //------EVENT LISTENERS	    var onFirstSlideImageLoaded	= function(){	        var $this = $(this);			NS_CAMPAIGN.loadCampaign( vars.currentSlideShowJSON );				        console.log('FIRSTslideloaded');	        console.log($this);	        	        if(vars.campaignAutoStart)	        {				$( document.getElementById('loadingIndicator') ).empty();				NS_CAMPAIGN.onAttemptToOpenGallery();			}	    };	    var onSlideImageLoaded	= function(){	        var $this = $(this);	        console.log('aslideloaded');	        console.log($this);	        	    };	    	    this.onSliderNavigationNumberClick = function(e)	    {	        //when the slide number menu is clicked - to change slides by index...with the 1 2 3 4	        var $thisBtn	= $(this);	        	        //update slideGalleryNav	        $thisBtn.parent().children().removeClass('current');	        $thisBtn.addClass('current');	        //move the scrollable Gallery	        	        window.scrollableAPI.seekTo( $thisBtn.index() );	        	        e.preventDefault();	        return false;	        	    };	    this.onAttemptToOpenGallery = function ()	    {	       NS_CAMPAIGN.startCampaignGallery();	    };	    this.onSlideNavigation = function(event,slideNum)	    { //when a slide is changed - either through the slide number menu or the next / prev button	        var $slideNumberNavDOM = $('#campaignGalleryNav .js-campaignPageNav');	        NS_CAMPAIGN.buildSlideRow2Information(slideNum);	        //console.log(slideNum)	        //update the slide number menu	        $slideNumberNavDOM.children().removeClass('current').eq(slideNum).addClass('current');	        	       // return false;	    };	    	    this.onChangeCampaign = function(e)	    {	        var $this		= $(this),	            newCatID	= $this.data('catid'),				loadingDOM	= document.getElementById('loadingIndicator');	            	        //find which campaign section we are loading	        $.each(window.slideShowJSON,function(i,ssJSON){	            if( newCatID == ssJSON.id )	                vars.currentSlideShowJSON = ssJSON;	        });			/*console.log('changing campaign');			console.log(loadingDOM);*/			$( loadingDOM ).empty();						var spinner = new Spinner(UTIL.spinJsOpts).spin( loadingDOM );	        //load it	        NS_CAMPAIGN.resetCampaignGallery();	        NS_CAMPAIGN.loadCampaignLandingSlide( vars.currentSlideShowJSON );	        //NS_CAMPAIGN.loadCampaign( vars.currentSlideShowJSON );	        	        	    };	    //------FUNCTIONS	    this.loadCampaignLandingSlide = function(slideshow)	    {/*builds the first slide of a campaign	       currently this does nothing diffrent than the normal loadSlide function, but was built seperatly just in case extra or diffrent functionality is needed*/	        var firstimagesrc = slideshow.slides[0].image,	            img = new Image();	            	        $('.js-firstSlide img').load(onFirstSlideImageLoaded)	            .error()	            .attr('src',firstimagesrc);	    };	    	    this.buildGallerySlideMenu = function(slideCount)	    {//build the slide number menu 1 2 3 4 5 that allows users to skip to diffrent sldies	        var $navList	= $('#campaignGalleryNav .js-campaignPageNav'),	            listHTML	= '<a class="current" href="#">1</a>',//start off with the first one and well make it current	            i			= 2;	        for( i = 2; i <= slideCount; i++ )	        {	            listHTML += '<a href="#">'+i+'</a>'	        }	        $navList.html(listHTML);	        this.resizeSlideNav($navList)	    };	    	    this.buildSlideRow2Information = function(slideNum)	    {//function updates row2 information for each slide	        	        var products = vars.currentSlideShowJSON.slides[slideNum].products;	    	        //set the modelname on the bottom left	        $('#campaignGalleryNav .js-galleryModelName').text( vars.currentSlideShowJSON.slides[slideNum].model );	        	        //refresh the product info and shop button	        var newLIlist = '',	            $productList = $('#campaignGalleryNav .js-galleryProductList').html(newLIlist),	            $shopBtn = $('#campaignGalleryNav .js-galleryShopBtn').hide();	        	        if( products.length > 0 )	        {	            //update product list	            var newLIlist = '';	            $.each(products,function(i,productName)	            {	                newLIlist += '<li>'+productName+'</li>';	            });	            //set the gallery list	            $productList.html(newLIlist);	            //set the shop by link	            $shopBtn.show().find('a').attr( 'href', '/quickshop.aspx?id=' + vars.currentSlideShowJSON.slides[slideNum].id );	        }	    	    };	    	    this.loadScrollablePlugin = function()	    {//actually load the scrollable plugin	        $("#scrollableCampaign").scrollable({	            circular:true,	            items:".items",	            onSeek:this.onSlideNavigation 	        });	        //$("#scrollableCampaign").scrollableAddClones(2);	        window.scrollableAPI = $('#scrollableCampaign').data('scrollable');	    };	    	    this.resizeSlideNav = function($navList)	    {	        	        /*console.log( $navList.width() );	        console.log( (($navList.parent().width() / 2)  - ($navList.width() / 2 ))  );*/	        $navList.css('left', (($navList.parent().width() / 2)  - ($navList.width() / 2 )) );	    };	    	    this.loadCampaign = function(slideshowJSON)	    {             vars.currentSlideShowJSON = slideshowJSON;	        this.buildGallerySlideMenu(slideshowJSON.slides.length);	        //load the slides into the scrollable gallery	        	        	        $.each(slideshowJSON.slides, function(i,val){	            if(i == 0) return;//we already built the first one	            	                var $templateSlide = $('.js-template.js-template-slide').clone().removeClass('js-template-slide js-template hide'),	                    $imageHolder = $templateSlide.find('.js-imageHolder').removeClass('.js-imageHolder'); 	            	                $imageHolder.attr('src',val.image);	                $templateSlide.appendTo('#scrollableCampaign #page.items');	                	                //window.scrollableAPI.addItem($templateSlide);	                	        });  	    };	    	    		this.startCampaignGallery = function(e)		{        	//adjustScrollable();            NS_CAMPAIGN.loadScrollablePlugin();            $('.slide').fadeTo('slow',1);            //setupScrollable();                       //show nav            NS_CAMPAIGN.buildSlideRow2Information(0)//update nav with clide0            $('#herolayout').animate({'height':vars.campaignOpenHeight},300);            NS_CAMPAIGN.resizeSlideNav( $('#campaignGalleryNav .js-campaignPageNav') );            $('#campaignGalleryNav').show();	        $('.next,.prev').fadeTo(300,1);	        $('#campaign-hero ').fadeOut();	    };	    	    this.closeCampaignGallery = function(e)	    {             if( window.scrollableAPI) window.scrollableAPI.seekTo(0);            //close nav            $('#herolayout').animate({'height':vars.campaignClosedHeight},300);            $('#campaignGalleryNav').hide();                  $('.slide:not(.js-firstSlide)').fadeTo(300,0);            $('.slide.cloned').fadeTo(300,0);            if(window.scrollableAPI)window.scrollableAPI.seekTo(0,0);          	        $('.next,.prev').fadeTo(300,0);	        $('#campaign-hero ').fadeIn(500);	        	         	        	    };	    this.resetCampaignGallery = function(e)	    {			//remove all slides that are clones, and all other html components other than the first slide inside #scrollabeCampaign	        $('.slide:not(.js-firstSlide),.slide.cloned','#scrollableCampaign').remove();	        $('#scrollableCampaign').data('scrollable',false);	        $('#scrollableCampaign').removeData('scrollable');	        $('.js-next,.js-prev','#scrollableCampaign').unbind('click');	        //console.log( $('#scrollableCampaign').data('scrollable') );	        if( window.scrollableAPI !== undefined ) 	        {	            window.scrollableAPI.seekTo(0,0);	            //window.scrollableAPI = null;	            //console.log( $('#scrollableCampaign').data('scrollable','') );	        }	    };    };